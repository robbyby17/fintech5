{"cells":[{"cell_type":"markdown","metadata":{"id":"oBpCRmhs79DN"},"source":["##Inisialisasi"]},{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"KQdkK_22Po43","executionInfo":{"status":"ok","timestamp":1657596783731,"user_tz":-420,"elapsed":3380,"user":{"displayName":"Robby","userId":"04922549052125523646"}},"outputId":"8eb47aa4-a250-4a82-b97e-a04f4d4c99ad"},"outputs":[{"output_type":"stream","name":"stdout","text":["Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n"]}],"source":["#Impor Package dan Libraries yang dibutuhkan\n","import numpy as np\n","import pandas as pd\n","from statistics import mean, stdev\n","from sklearn import preprocessing\n","from sklearn import linear_model\n","from sklearn.model_selection import StratifiedKFold\n","from sklearn.metrics import confusion_matrix, classification_report\n","\n","from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","execution_count":2,"metadata":{"id":"CNe9QcEhPo2F","executionInfo":{"status":"ok","timestamp":1657596783731,"user_tz":-420,"elapsed":5,"user":{"displayName":"Robby","userId":"04922549052125523646"}}},"outputs":[],"source":["#Impor dataset\n","df_train = pd.read_csv('/content/drive/MyDrive/Colab Notebooks/Fintech Demo Day/train.csv', sep=';')\n","df_test = pd.read_csv('/content/drive/MyDrive/Colab Notebooks/Fintech Demo Day/test.csv', sep=';')"]},{"cell_type":"code","source":["le = preprocessing.LabelEncoder()\n","df_train = df_train.apply(le.fit_transform)\n","df_test = df_test.apply(le.fit_transform)"],"metadata":{"id":"UA1AT2LSLb6q","executionInfo":{"status":"ok","timestamp":1657596783731,"user_tz":-420,"elapsed":4,"user":{"displayName":"Robby","userId":"04922549052125523646"}}},"execution_count":3,"outputs":[]},{"cell_type":"code","source":["X = df_train.drop('y',axis = 1)\n","y = df_train['y']\n","x_test = df_test.drop('y',axis = 1)\n","y_test = df_test['y']"],"metadata":{"id":"JlmzBJsSgkpg","executionInfo":{"status":"ok","timestamp":1657596783732,"user_tz":-420,"elapsed":5,"user":{"displayName":"Robby","userId":"04922549052125523646"}}},"execution_count":5,"outputs":[]},{"cell_type":"code","source":["scaler = preprocessing.MinMaxScaler()\n","x_scaled = scaler.fit_transform(X)\n","x_test_scaled = scaler.fit_transform(x_test)"],"metadata":{"id":"qSqGbDbLaJmV","executionInfo":{"status":"ok","timestamp":1657596783732,"user_tz":-420,"elapsed":4,"user":{"displayName":"Robby","userId":"04922549052125523646"}}},"execution_count":6,"outputs":[]},{"cell_type":"code","source":["lr = linear_model.LogisticRegression()"],"metadata":{"id":"IvOBYirUNkZ6","executionInfo":{"status":"ok","timestamp":1657596784275,"user_tz":-420,"elapsed":547,"user":{"displayName":"Robby","userId":"04922549052125523646"}}},"execution_count":7,"outputs":[]},{"cell_type":"code","source":["skf = StratifiedKFold(n_splits=10, shuffle=True, random_state=1708)\n","lst_accu_stratified = []\n","  \n","for train_index, test_index in skf.split(X, y):\n","    x_train_fold, x_test_fold = x_scaled[train_index], x_scaled[test_index]\n","    y_train_fold, y_test_fold = y[train_index], y[test_index]\n","    lr.fit(x_train_fold, y_train_fold)\n","    lst_accu_stratified.append(lr.score(x_test_fold, y_test_fold))"],"metadata":{"id":"u04vwfRAPUjV","executionInfo":{"status":"ok","timestamp":1657596791352,"user_tz":-420,"elapsed":7079,"user":{"displayName":"Robby","userId":"04922549052125523646"}}},"execution_count":8,"outputs":[]},{"cell_type":"code","source":["print('List of possible accuracy:', lst_accu_stratified)\n","print('\\nMaximum Accuracy That can be obtained from this model is:',\n","      max(lst_accu_stratified)*100, '%')\n","print('\\nMinimum Accuracy:',\n","      min(lst_accu_stratified)*100, '%')\n","print('\\nOverall Accuracy:',\n","      mean(lst_accu_stratified)*100, '%')\n","print('\\nStandard Deviation is:', stdev(lst_accu_stratified))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"aHABXmwYLb1g","executionInfo":{"status":"ok","timestamp":1657596791353,"user_tz":-420,"elapsed":12,"user":{"displayName":"Robby","userId":"04922549052125523646"}},"outputId":"3e314770-7ea3-4120-b601-befe03743f86"},"execution_count":9,"outputs":[{"output_type":"stream","name":"stdout","text":["List of possible accuracy: [0.891640866873065, 0.893828798938288, 0.8911745189117452, 0.8836540588365406, 0.891616898916169, 0.8913957089139571, 0.8967042689670427, 0.8905109489051095, 0.8900685689006856, 0.891616898916169]\n","\n","Maximum Accuracy That can be obtained from this model is: 89.67042689670427 %\n","\n","Minimum Accuracy: 88.36540588365406 %\n","\n","Overall Accuracy: 89.12211537078771 %\n","\n","Standard Deviation is: 0.0032741439252525514\n"]}]},{"cell_type":"code","execution_count":10,"metadata":{"id":"fCSt6JonPoVJ","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1657596791353,"user_tz":-420,"elapsed":11,"user":{"displayName":"Robby","userId":"04922549052125523646"}},"outputId":"77e471ef-a320-4221-e814-78d3f7c76418"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[3606,  394],\n","       [ 215,  306]])"]},"metadata":{},"execution_count":10}],"source":["#Menentukan confusion matrix\n","y_predict=(lr.predict(x_test_scaled) > 0.5).astype(\"int32\")\n","confusion_matrix(y_test, y_predict, labels=[0, 1])"]},{"cell_type":"code","execution_count":11,"metadata":{"id":"18b2RaZu4gyy","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1657596791353,"user_tz":-420,"elapsed":10,"user":{"displayName":"Robby","userId":"04922549052125523646"}},"outputId":"b3565a1d-af7f-433c-b1b6-2a0accee1c01"},"outputs":[{"output_type":"stream","name":"stdout","text":["              precision    recall  f1-score   support\n","\n","           0       0.94      0.90      0.92      4000\n","           1       0.44      0.59      0.50       521\n","\n","    accuracy                           0.87      4521\n","   macro avg       0.69      0.74      0.71      4521\n","weighted avg       0.89      0.87      0.87      4521\n","\n"]}],"source":["print(classification_report(y_test, y_predict))"]}],"metadata":{"colab":{"collapsed_sections":[],"name":"Fintech KFold","provenance":[]},"gpuClass":"standard","kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"},"accelerator":"GPU"},"nbformat":4,"nbformat_minor":0}